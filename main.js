(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{dm:()=>C,ob:()=>Y,iu:()=>ee,G_:()=>ne,wD:()=>ie,mo:()=>A,ZH:()=>w,Qn:()=>T,jt:()=>oe,rz:()=>E});var t="wff-cohort-23",n="https://nomoreparties.co/v1",o="".concat(n,"/").concat(t,"/users/me"),r="".concat(n,"/").concat(t,"/cards"),c="".concat(n,"/").concat(t,"/users/me"),u="".concat(n,"/").concat(t,"/cards"),i="".concat(n,"/").concat(t,"/cards"),a="".concat(n,"/").concat(t,"/cards/likes"),l="".concat(n,"/").concat(t,"/cards/likes"),p="".concat(n,"/").concat(t,"/users/me/avatar"),s=new Headers;function d(){return fetch(o,{method:"GET",headers:s}).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)}))}function _(e,t,n,o,r,c,u){var i=E.querySelector(".card").cloneNode(!0),p=i.querySelector(".card__description"),d=i.querySelector(".card__image"),_=p.querySelector(".card__title"),v=i.querySelector(".card__delete-button"),y=p.querySelector(".card__like"),m=y.querySelector(".card__like-button"),h=y.querySelector(".card__like-number");return!1!==u&&!1!==e?v.addEventListener("click",(function(){return f(e,i)})):v.hidden=!0,h.textContent=o.length,r&&m.classList.add("card__like-button_is-active"),m.addEventListener("click",(function(t){return function(e,t,n,o){var r,c;e.target.classList.contains("card__like-button_is-active")?(r=t,c={method:"DELETE",headers:s},fetch("".concat(l,"/").concat(r),c).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)}))).then((function(t){o.textContent=t.likes.length,e.target.classList.remove("card__like-button_is-active")})):function(e){var t={method:"PUT",headers:s};return fetch("".concat(a,"/").concat(e),t).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)}))}(t).then((function(t){o.textContent=t.likes.length,e.target.classList.add("card__like-button_is-active")}))}(t,e,o.length,h)})),d.addEventListener("click",(function(){return c(d,_)})),d.src=n,d.classList.add("card__image"),d.alt="Image of ".concat(t),_.textContent=t,i}function f(e,t){var n,o;(n=e,o={method:"DELETE",headers:s},fetch("".concat(i,"/").concat(n),o).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)}))).then((function(){return t.remove()})).catch((function(e){return console.error(e)}))}s.append("Authorization","97b196fd-7e0c-4cfe-864d-aea1e8f81a13"),s.append("Content-Type","application/json");var v=[],y=function(e){(e.target.matches(".popup")||e.target.matches(".popup__close"))&&S(e.currentTarget)},m=function(e){"Escape"===e.key&&S(document.querySelector(".popup_is-opened"))};function h(e){document.addEventListener("keydown",m),e.addEventListener("click",y),e.classList.add("popup_is-opened")}function S(e){document.removeEventListener("keydown",m),e.removeEventListener("click",y),e.classList.remove("popup_is-opened")}function q(e,t){var n=e.querySelectorAll(t.inputSelector),o=e.querySelector(t.submitButtonSelector);n.forEach((function(r){r.addEventListener("input",(function(){b(n,o,t.inactiveButtonClass),r.validity.patternMismatch?r.setCustomValidity(r.dataset.errorMessage):r.setCustomValidity(""),r.validity.valid?L(e,r):function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));o.textContent=n,t.classList.add("popup__input_type-error"),o.classList.add("popup__error_visible")}(e,r,r.validationMessage),b(n,o,t.inactiveButtonClass)}))}))}function k(e,t){e.disabled=!1,e.classList.remove(t),e.classList.remove("popup__button:hover:disabled")}function b(e,t,n){!function(e){return Array.from(e).some((function(e){return!e.validity.valid}))}(e)?k(t,n):function(e,t){e.disabled=!0,e.classList.add(t),e.classList.add("popup__button:hover:disabled")}(t,n)}function L(e,t){var n=e.querySelector(".".concat(t.id,"-error"));n.textContent="",t.classList.remove("popup__input_type-error"),n.classList.remove("popup__error_visible")}var E=document.querySelector("#card-template").content,g=document.querySelector(".content"),C=g.querySelector(".places__list"),x=g.querySelector(".profile"),j=x.querySelector(".profile__info"),w=x.querySelector(".profile__image"),T=j.querySelector(".profile__title"),A=j.querySelector(".profile__description"),B=x.querySelector(".profile__add-button"),O=j.querySelector(".profile__edit-button"),D=document.querySelector(".popup_type_new-card"),P=D.querySelector(".popup__content"),H=D.querySelector(".popup__close"),N=D.querySelector(".popup__button"),G=P.querySelector(".popup__form"),I=G.querySelector(".popup__input_type_card-name"),J=G.querySelector(".popup__input_type_url");D.classList.add("popup_is-animated");var M=document.querySelector(".popup_type_edit"),z=M.querySelector(".popup__content"),V=M.querySelector(".popup__button"),Q=z.querySelector(".popup__close"),U=z.querySelector(".popup__form"),Z=U.querySelector(".popup__input_type_name"),F=U.querySelector(".popup__input_type_description");M.classList.add("popup_is-animated");var K=document.querySelector(".popup_type_image"),R=K.querySelector(".popup__content_content_image"),W=R.querySelector(".popup__image"),X=R.querySelector(".popup__caption");K.classList.add("popup_is-animated");var Y=document.querySelector(".popup__type_edit-avatar"),$=Y.querySelector(".popup__content"),ee=Y.querySelector(".popup__button"),te=(Y.querySelector(".popup__close"),$.querySelector(".popup__form")),ne=te.querySelector(".popup__input_type_url");function oe(e,t){W.src=e.src,W.alt=e.alt,X.textContent=t.textContent,h(K),K.addEventListener("click",(function(){return re(K)}))}function re(e){S(e),e.classList.contains("popup_type_image")||function(e,t){var n=e.querySelector(t.formSelector),o=n.querySelectorAll(t.inputSelector),r=n.querySelector(t.submitButtonSelector);o.forEach((function(e){L(n,e)})),k(r,t.inactiveButtonClass)}(e,ae)}function ce(e){var t,n,o;e.preventDefault(),N.textContent="Сохранить...",(t=I.value,n=J.value,o=JSON.stringify({name:t,link:n}),fetch(u,{method:"POST",headers:s,body:o}).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)}))).then((function(e){var t=_(e._id,e.name,e.link,e.likes,!1,oe,f);C.prepend(t),G.reset(),N.textContent="Сохранить",S(D)}))}function ue(e){e.preventDefault(),V.textContent="Сохранить...";var t,n,o,r=Z.value,u=F.value;(t=r,n=u,o=JSON.stringify({name:t,about:n}),fetch(c,{method:"PATCH",headers:s,body:o,redirect:"follow"}).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)}))).then((function(){V.textContent="Сохранить"})),T.textContent=r,A.textContent=u,S(M),Z.value="",F.value=""}Y.classList.add("popup_is-animated"),B.addEventListener("click",(function(){I.value="",J.value="",h(D),D.addEventListener("submit",ce),H.removeEventListener("click",(function(){return re(D)}))})),O.addEventListener("click",(function(){h(M),Z.value=T.textContent,F.value=A.textContent,U.addEventListener("submit",ue),Q.removeEventListener("click",(function(){return re(M)}))})),w.addEventListener("click",(function(){ne.value="",h(Y),ie.addEventListener("click",(function(e){return function(e,t){var n,o;ee.textContent="Сохранить...",e.preventDefault(),(n=t.value,o=JSON.stringify({avatar:n}),fetch(p,{method:"PATCH",headers:s,body:o}).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)}))).then((function(e){w.style.backgroundImage="url(".concat(e.avatar,")"),ee.textContent="Сохранить",S(Y),ne.value=""}))}(e,ne)}))})),te.querySelectorAll(".popup__input");var ie=te.querySelector(".popup__button"),ae={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__error",errorClass:"popup__error_visible"};d().then((function(e){A.textContent=e.about,T.textContent=e.name,w.style.backgroundImage="url(".concat(e.avatar,")"),w.alt="Аватар пользователя"})).catch((function(e){console.log("".concat(e," Ошибка. Пользователь не найден"))})),d().then((function(e){return e})).then((function(e){fetch(r,{method:"GET",headers:s}).then((function(e){if(e.ok)return e.json()})).catch((function(e){return console.error(e)})).then((function(e){e.forEach((function(e){v.push({_id:e._id,name:e.name,link:e.link,likes:e.likes,owner:{_id:e.owner._id,name:e.name,about:e.about}})}))})).then((function(){v.forEach((function(t){var n,o=!1,r=(n=!1,e._id===t.owner._id&&(n=!0),n);t.likes.forEach((function(t){o=function(e,t){var n=!1;return e===t&&(n=!0),n}(t._id,e._id)}));var c=_(t._id,t.name,t.link,t.likes,o,oe,r);return C.append(c),v}))})).catch((function(e){console.log("".concat(e," Ошибка. Карточки не найдены"))}))})).catch((function(e){console.log("".concat(e," Ошибка. Карточки не найдены"))})),q(U,ae),q(G,ae),q(te,ae)})();